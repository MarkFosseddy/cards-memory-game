var t=Object.defineProperty,e=(e,s,i)=>(((e,s,i)=>{s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i})(e,"symbol"!=typeof s?s+"":s,i),i);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerpolicy&&(e.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?e.credentials="include":"anonymous"===t.crossorigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();const s=class{constructor(t){e(this,"el"),e(this,"ctx"),this.el=document.createElement("canvas"),this.ctx=(()=>{const t=this.el.getContext("2d");if(!t)throw new Error("Tried to access 2d canvas rendering context, but unlucky.");return t})(),this.el.width=s.WIDTH,this.el.height=s.HEIGHT,this.el.style.border="1px solid black",t.appendChild(this.el)}};let i=s;e(i,"TILE",20),e(i,"WIDTH",32*s.TILE),e(i,"HEIGHT",29*s.TILE);class o{constructor(t,e){this.x=t,this.y=e}}function r(t){const{clientX:e,clientY:s,target:i}=t,r=i.getBoundingClientRect();return new o(e-r.left,s-r.top)}function n(t,e){return e.x>=t.pos.x&&e.x<=t.pos.x+t.w&&e.y>=t.pos.y&&e.y<=t.pos.y+t.h}class l{constructor(t,e,s,i=1){this.r=t,this.g=e,this.b=s,this.a=i}toString(){return`rgba(${this.r}, ${this.g}, ${this.b}, ${this.a})`}isEqualTo(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}}const a=class{constructor(t,s,i){e(this,"pos"),e(this,"center"),e(this,"color"),e(this,"w",a.WIDTH),e(this,"h",a.HEIGHT),e(this,"scale",1),e(this,"dscale",0),e(this,"alpha",1),e(this,"dalpha",0),this.pos=new o(t,s),this.center=new o(t+this.w/2,s+this.h/2),this.color={back:new l(0,0,0),front:i}}draw(t){t.save(),t.translate(this.center.x,this.center.y),t.scale(this.scale,1),t.translate(-this.center.x,-this.center.y),window.showCardFront?t.fillStyle=this.color.front.toString():t.fillStyle=this.scale>0?this.color.back.toString():this.color.front.toString(),t.fillRect(this.pos.x,this.pos.y,this.w,this.h),t.lineWidth=2,t.strokeStyle=this.color.back.toString(),t.strokeRect(this.pos.x,this.pos.y,this.w,this.h),t.setTransform(1,0,0,1,0,0),t.restore()}update(t){var e,s;0===this.dscale&&0===this.dalpha||(this.scale=(e=this.scale+this.dscale*t,s=1,Number(e.toFixed(s))),(this.scale<=-1||this.scale>=1)&&(this.dscale=0),this.alpha+=this.dalpha*t,(this.alpha>=1||this.alpha<=0)&&(this.dalpha=0),this.color.front.a=this.alpha,this.color.back.a=this.alpha)}};let h=a;e(h,"WIDTH",3*i.TILE),e(h,"HEIGHT",4*i.TILE);class c{constructor(t,s,i){e(this,"pos"),e(this,"text"),e(this,"color",new l(0,0,0)),e(this,"align",""),e(this,"baseline",""),e(this,"font",""),this.pos=new o(s,i),this.text=t}draw(t){t.save(),this.align&&(t.textAlign=this.align),this.baseline&&(t.textBaseline=this.baseline),this.font&&(t.font=this.font),t.fillStyle=this.color.toString(),t.fillText(this.text,this.pos.x,this.pos.y),t.restore()}}const d=class{constructor(t,s,i){e(this,"pos"),e(this,"text"),e(this,"w",d.WIDTH),e(this,"h",d.HEIGHT),e(this,"hovered",!1),e(this,"color",new l(0,0,0)),e(this,"hoveredColor",new l(255,255,255)),e(this,"onClick",(()=>{})),this.pos=new o(s,i),this.text=new c(t,s+this.w/2,i+this.h/2),this.text.align="center",this.text.baseline="middle",this.text.font="25px serif"}draw(t){t.save(),this.hovered?(t.fillStyle=this.color.toString(),t.fillRect(this.pos.x,this.pos.y,this.w,this.h),this.text.color=this.hoveredColor):(t.lineWidth=2,t.strokeStyle=this.color.toString(),t.strokeRect(this.pos.x,this.pos.y,this.w,this.h),this.text.color=this.color),t.restore(),this.text.draw(t)}};let f=d;e(f,"WIDTH",10*i.TILE),e(f,"HEIGHT",3*i.TILE);const p={red:[255,0,0],lime:[0,255,0],blue:[0,0,255],yellow:[255,255,0],cyan:[0,255,255],magenta:[255,0,255],maroon:[128,0,0],green:[0,128,0],purple:[128,0,128],teal:[0,128,128],navy:[0,0,128],wheat:[245,222,179]};var u,w;window.showGrid=!1,window.showCardFront=!1,window.flipSpeed=5,window.fadeOutSpeed=4,window.unflipDelay=.1,(w=u||(u={}))[w.Menu=0]="Menu",w[w.Running=1]="Running",w[w.Paused=2]="Paused",w[w.Finished=3]="Finished";const y=new i(document.body),T={cards:function(){let t=[],e=Object.keys(p),s=function(t){let e=[...t],s=t.length,i=0;for(;0!==s;)i=Math.floor(Math.random()*s),s-=1,[e[s],e[i]]=[e[i],e[s]];return e}([...e,...e]),o=2,r=2;for(const n of s){let e=new l(...p[n]);t.push(new h(o*i.TILE,r*i.TILE,e)),o>=26?(o=2,r+=7):o+=5}return t}(),flippedCards:[],state:0,unflipDelay:window.unflipDelay},g=new c("Card Memory Game",i.WIDTH/2,6*i.TILE);g.font="50px serif",g.align="center";const I=new f("Start",i.WIDTH/2-f.WIDTH/2,10*i.TILE);I.onClick=()=>{T.state=1};const m=new c("You are the Winner!",i.WIDTH/2,i.HEIGHT/2-100);m.align="center",m.font="40px serif";let x=0;requestAnimationFrame((function t(e){const s=.001*(e-x);if(s<=0)return void requestAnimationFrame(t);console.assert(s>0),x=e;const{ctx:o}=y;switch(o.clearRect(0,0,i.WIDTH,i.HEIGHT),T.state){case 0:g.draw(o),I.draw(o);break;case 3:m.draw(o);break;case 1:T.flippedCards=[];for(const t of T.cards)t.scale<=-1&&T.flippedCards.push(t);if(T.flippedCards.length>=2){const[t,e]=T.flippedCards;if(!t||!e)throw new Error("Will this ever happen though?");if(t.color.front.isEqualTo(e.color.front))t.alpha>0||e.alpha>0?t.dalpha=e.dalpha=-window.fadeOutSpeed:(T.cards=T.cards.filter((t=>!T.flippedCards.includes(t))),T.flippedCards=[]);else if(T.unflipDelay<=0){T.unflipDelay=window.unflipDelay,T.flippedCards=[];for(const t of T.cards)t.scale<=-1&&(t.dscale=window.flipSpeed)}else T.unflipDelay-=s}0===T.cards.length&&(T.state=3);for(const t of T.cards)t.update(s);for(const t of T.cards)t.draw(o)}if(window.showGrid){o.beginPath();for(let t=i.TILE;t<i.WIDTH;t+=i.TILE)o.moveTo(t,0),o.lineTo(t,i.HEIGHT);for(let t=i.TILE;t<i.HEIGHT;t+=i.TILE)o.moveTo(0,t),o.lineTo(i.WIDTH,t);o.stroke()}requestAnimationFrame(t)})),y.el.addEventListener("mousemove",(t=>{if(0!==T.state)return;const e=r(t);n(I,e)?(I.hovered=!0,y.el.style.cursor="pointer"):(I.hovered=!1,y.el.style.cursor="default")})),y.el.addEventListener("click",(t=>{const e=r(t);switch(T.state){case 0:if(!n(I,e))return;I.onClick(),y.el.style.cursor="default";break;case 1:{let t=0;for(const e of T.cards)if(e.scale<1&&(t+=1,t>=2))return;for(const s of T.cards)!n(s,e)||s.scale<=-1||(s.dscale=-window.flipSpeed)}}})),document.addEventListener("keypress",(t=>{switch(t.code){case"KeyG":window.showGrid=!window.showGrid;break;case"KeyF":window.showCardFront=!window.showCardFront;break;default:return}}));
